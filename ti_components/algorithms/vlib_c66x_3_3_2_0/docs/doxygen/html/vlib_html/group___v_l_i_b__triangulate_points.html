<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>VLIB: VLIB_triangulatePoints</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<table width=100%>
<tr>
  <td bgcolor="black" width="1"><a href="http://www.ti.com"><img border=0 src="tilogo.gif"></a></td>
  <td bgcolor="red"><img src="titagline.gif"></td>
</tr>
</table>
<!-- Generated by Doxygen 1.5.1-p1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<h1>VLIB_triangulatePoints</h1><hr><a name="_details"></a><h2>Detailed Description</h2>

<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_l_i_b__triangulate_points.html#g177b3db4578b65888e0501d2ca0bb816">VLIB_triangulatePoints</a> (VLIB_F32 curTrack[restrict], VLIB_F32 camExtPrm[restrict], uint8_t curTrackLength[restrict], int32_t maxIter, VLIB_F32 Xcam[restrict], VLIB_F32 scratch[restrict], int32_t totalTracks, uint8_t validOut[restrict], uint32_t flag)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="g177b3db4578b65888e0501d2ca0bb816"></a><!-- doxytag: member="c66/VLIB_triangulatePoints.h::VLIB_triangulatePoints" ref="g177b3db4578b65888e0501d2ca0bb816" args="(VLIB_F32 curTrack[restrict], VLIB_F32 camExtPrm[restrict], uint8_t curTrackLength[restrict], int32_t maxIter, VLIB_F32 Xcam[restrict], VLIB_F32 scratch[restrict], int32_t totalTracks, uint8_t validOut[restrict], uint32_t flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t VLIB_triangulatePoints           </td>
          <td>(</td>
          <td class="paramtype">VLIB_F32&nbsp;</td>
          <td class="paramname"> <em>curTrack</em>[restrict], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VLIB_F32&nbsp;</td>
          <td class="paramname"> <em>camExtPrm</em>[restrict], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>curTrackLength</em>[restrict], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&nbsp;</td>
          <td class="paramname"> <em>maxIter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VLIB_F32&nbsp;</td>
          <td class="paramname"> <em>Xcam</em>[restrict], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VLIB_F32&nbsp;</td>
          <td class="paramname"> <em>scratch</em>[restrict], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&nbsp;</td>
          <td class="paramname"> <em>totalTracks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>validOut</em>[restrict], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>flag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Description:</b></dt><dd>This API takes set of tracked 2D feature points from which 3D points are estimated using Hartley's Iterative LS method described in the paper reference provided below.</dd></dl>
<dl class="user" compact><dt><b></b></dt><dd></dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>curTrack[]</em>&nbsp;</td><td>: Current track data after multiplying with inverse of intrinsic parameters. i.e. [x,y,1] = K<sup>-1</sup> * [x',y',1]; Format of intrinsic parameter is [f<sub>x</sub> 0 x<sub>0</sub> 0 f<sub>y</sub> y<sub>0</sub> 0 0 1.0]. Where f<sub>x</sub> and f<sub>y</sub> are focal length parameters in x and y direction. Whereas(x<sub>0</sub>, y<sub>0</sub>) is the principal point , where optic axis intersects the image plane. Two track data are clubbed together. x/y-coordinates of two tracks are placed together. Lets assume two tracks are {(x<sub>0</sub>,y<sub>0</sub>),(x<sub>1</sub>,y<sub>1</sub>),(x<sub>2</sub>,y<sub>2</sub>),(x<sub>3</sub>,y<sub>3</sub>),(x<sub>4</sub>,y<sub>4</sub>),(x<sub>5</sub>,y<sub>5</sub>)} &amp; {(u<sub>0</sub>,v<sub>0</sub>),(u<sub>1</sub>,v<sub>1</sub>),(u<sub>2</sub>,v<sub>2</sub>),(u<sub>3</sub>,v<sub>3</sub>),(u<sub>4</sub>,v<sub>4</sub>),(u<sub>5</sub>,v<sub>5</sub>)}. where (x<sub>i</sub>,y<sub>i</sub>) is the feature point location in i<sup>th</sup> frame for particular track. (u<sub>i</sub>,v<sub>i</sub>) is the feature point location in i<sup>th</sup> frame for another track. Expected format for curTrack is curTrack[] = {x<sub>0</sub>, u<sub>0</sub>, y<sub>0</sub>, v<sub>0</sub>, x<sub>1</sub>, u<sub>1</sub>, y<sub>1</sub>, v<sub>1</sub>, .. so on}. Here (x<sub>0</sub>,y<sub>0</sub>) or (u<sub>0</sub>,v<sub>0</sub>) is oldest location , whereas (x<sub>1</sub>,y<sub>1</sub>) or (u<sub>1</sub>,v<sub>1</sub>) is second oldest frame location, and so on. If any frame location is not available for a track then its corresponding place in <code>curTrack</code> is don't care. Maximum 6 frames locations are allowed in a given track. For a given track pair total length will be 6*2*2 = 24. Hence second pair of track will be filled from curTrack[24] to curTrack[47] and so on.</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>camExtPrm</em>&nbsp;</td><td>: Camera extrinsic parameters. Base format of camera extrinsic parameters is P = [ r00 r01 r02 t0 r10 r11 r12 t1 r20 r21 r22 t2], where rij are the rotation parameter, and ti are the translation parameters. Base camera extrinsic parameters are of size 12, but for optimization purpose it is asked as 20 elements with some of the elements repeated. Refer to implementation notes below. Maximum 6 frames can be considered for a 3D point estimation using triangulation. Oldest camera extrinsic parameter is placed at '0' index, and latest camera parameter is placed at index '5'.</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>curTrackLength</em>&nbsp;</td><td>: Array of values for each track lengths. E.g. If curTrackLength[i]=2, will triangulate using points (x<sub>4</sub>,y<sub>4</sub>) and (x<sub>5</sub>,y<sub>5</sub>) of track i with extrinsic parameters camExtPrm[4] and camExtPrm[5]. If curTrackLength[i]=6, will triangulate using points (x<sub>0</sub>,y<sub>0</sub>),(x<sub>1</sub>,y<sub>1</sub>),..., (x<sub>5</sub>,y<sub>5</sub>) of track i, and extrinsic parameters camExtPrm[0],...,camExtPrm[5].</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>maxIter</em>&nbsp;</td><td>: Maximum iteration of triangulation as described in Iterative LS Method.</td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>Xcam</em>&nbsp;</td><td>: 3-D output generated after triangulation API. Two 3D outputs are clubbed together. X(or Y or Z) co-ordinates are clubbed together. e.g X1X0Y1Y0Z1Z0X3X2Y3Y2Z3Z2....so on. Here [X0, Y0, Z0] is one 3D point form one track, whereas [X1, Y1, Z1] is another 3D point output from another track.</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>scratch</em>&nbsp;</td><td>: Scratch area to be used, size of this scratch area is (N/2)*1540, where 'N' = totalTracks if totalTracks is even or =totalTracks+1 if totalTracks is odd.. E.g. If <code>totalTracks</code> is 5, then total scratch required will be ((5+1)/2)*1540. Similarly if <code>totalTracks</code> is 20 then total scratch requirement is (20/2)*1540.</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>totalTracks</em>&nbsp;</td><td>: Total number of tracks to be processed.</td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>validOut</em>&nbsp;</td><td>: Output flag for each track, whether a solution was found or not. '1' indicates a solution was found, whereas '0' indicates solution could not be found.</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>flag</em>&nbsp;</td><td>: Flag to enable or disable high precision triangulation. '1' will enable high precision triangulation.</td></tr>
  </table>
</dl>
<dl class="user" compact><dt><b>Implementation Notes:</b></dt><dd><ul>
<li>This code is implemented for floating point DSP processor e.g. C6600</li><li>Recommended value of <code>maxIter</code> is 10. However lower value of it will reduce the cycle consumption without affecting the quality of output much.</li><li>Camera extrinsic parameters <code>camExtPrm</code> are expected in specific format. Original camera extrinsic ('P')parameter is of size [3x4]. Expected camera extrinsic parameter here is of size [20]. Format for this is as {P(8),P(0),P(4),P(9),P(1),P(5),P(10),P(11),P(2),P(6),P(3),P(7),P(8),P(8),P(9),P(9),P(10),P(10),P(11),P(11)}. Some of the data elements in array is replicated to avoid few overheads inside kernel.</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Benchmarks:</b></dt><dd>See VLIB_Test_Report.html for cycle and memory information. </dd></dl>

</div>
</div><p>
<hr size="1"><small>
Copyright  2018, Texas Instruments Incorporated</small>
</body>
</html>
