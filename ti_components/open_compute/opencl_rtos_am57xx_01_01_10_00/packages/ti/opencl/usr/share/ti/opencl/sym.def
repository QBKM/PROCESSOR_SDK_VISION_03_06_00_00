/******************************************************************************
 * Copyright (c) 2013-2014, Texas Instruments Incorporated - http://www.ti.com/
 *   All rights reserved.
 *
 *   Redistribution and use in source and binary forms, with or without
 *   modification, are permitted provided that the following conditions are met:
 *       * Redistributions of source code must retain the above copyright
 *         notice, this list of conditions and the following disclaimer.
 *       * Redistributions in binary form must reproduce the above copyright
 *         notice, this list of conditions and the following disclaimer in the
 *         documentation and/or other materials provided with the distribution.
 *       * Neither the name of Texas Instruments Incorporated nor the
 *         names of its contributors may be used to endorse or promote products
 *         derived from this software without specific prior written permission.
 *
 *   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 *   AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 *   IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 *   ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 *   LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 *   CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 *   SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 *   INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 *   CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 *   ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 *   THE POSSIBILITY OF SUCH DAMAGE.
 *****************************************************************************/

/*-----------------------------------------------------------------------------
* Monitor requires run time initialization (rom model) as it requires
* initialization of L2 data
*----------------------------------------------------------------------------*/
/*--rom_model*/
--retain="Edma*"
--retain="EdmaMgr*"
--retain="__c99*"
--retain="_Z*"
--retain="read_mem_fence"
--retain="write_mem_fence"
--retain="barrier"
--retain="mem_fence"
--retain="native_divide"
--retain="native_dividef"
/*--retain="dsp.lib<*>(*)"
--retain="libm.lib<*>(*)" */
--retain="GOMP_*"
--retain="omp_*"
--retain="__gomp_flush0"
--retain="__ti_omp_dsp*"
--retain="EdmaMgr_*"
--retain="__touch"
--retain="__core_num"
--retain="__sem_*"
--retain="_local_*"
--retain="ti_sysbios_family_c66_Cache_w*"
--retain="ti_sysbios_family_c66_Cache_inv*"

--retain="printf"
--retain="puts"
--retain="_minit"
--retain="malloc"
--retain="calloc"
--retain="realloc"
--retain="log"
--retain="logf"
--retain="sqrt"
--retain="__heap_init*"
--retain="__malloc_*"
--retain="__calloc_*"
--retain="__realloc_*"
--retain="__free_*"
--retain="__memalign_*"
--retain=EdmaMgr_alloc
--retain=EdmaMgr_copy2D2DSep
--retain=EdmaMgr_free
--retain=EdmaMgr_wait

#define L2_LINE_SIZE 128

SECTIONS
{
    .text: load >> DSP1_CODE_MEM
    .ti.decompress: load > DSP1_CODE_MEM
    .bss:heapMemL2 > DSP1_DATA_MEM
    .ocl_local_overlay >DSP1_DATA_MEM
    GROUP: load > DSP1_DATA_MEM
    {
        .bss:
        .neardata:
        .rodata:
    }

    .switch: load >> DSP1_CODE_MEM
    .sysmem: load > DSP1_DATA_MEM
    .args: load > DSP1_DATA_MEM align = 0x4, fill = 0

    .ti.handler_table: load > DSP1_DATA_MEM
    .c6xabi.extab: load >> DSP1_CODE_MEM
    .ddr: load > DSP1_CODE_MEM
    .private: load > DSP1_DATA_MEM, fill = 0x0
    .fast_shared_noncached: load > DSP1_DATA_MEM, fill = 0x0
}

SECTIONS
{

    .workgroup_config: > DSP1_DATA_MEM  palign(L2_LINE_SIZE)

}

/*-----------------------------------------------------------------------------
* Define symbols that mark the OpenCL global and local memory ranges.
*----------------------------------------------------------------------------*/
ocl_local_mem_start  = start(OCMC_RAM2);
ocl_local_mem_size   = size(OCMC_RAM2);

ocl_l1d_mem_size     = size(L1DSRAM);
ocl_l1d_mem_start    = start(L1DSRAM);

--export ocl_local_mem_start
--export ocl_local_mem_size

/*-----------------------------------------------------------------------------
* Place the far data from the framework components into l2 rather than ddr,
* becuase they are core private
*----------------------------------------------------------------------------*/
/*SECTIONS
{
    .fardata: load >> DDR3
    .far: load >> DDR3
    .gdb_server: >> DDR3
}*/

--symbol_map=acosd=acos
--symbol_map=acoshd=acosh
--symbol_map=acospid=acospi
--symbol_map=asind=asin
--symbol_map=asinhd=asinh
--symbol_map=asinpid=asinpi
--symbol_map=atand=atan
--symbol_map=atan2d=atan2
--symbol_map=atanhd=atanh
--symbol_map=atanpid=atanpi
--symbol_map=atan2pid=atan2pi
--symbol_map=cbrtd=cbrt
--symbol_map=ceild=ceil
--symbol_map=copysignd=copysign
--symbol_map=cosd=cos
--symbol_map=coshd=cosh
--symbol_map=cospid=cospi
--symbol_map=erfcd=erfc
--symbol_map=erfd=erf
--symbol_map=expd=exp
--symbol_map=exp2d=exp2
--symbol_map=exp10d=exp10
--symbol_map=expm1d=expm1
--symbol_map=fabsd=fabs
--symbol_map=fdimd=fdim
--symbol_map=floord=floor
--symbol_map=fmad=fma
--symbol_map=fmaxd=fmax
--symbol_map=fmind=fmin
--symbol_map=fmodd=fmod
--symbol_map=fractd=fract
--symbol_map=frexpd=frexp
--symbol_map=hypotd=hypot
--symbol_map=ilogbd=ilogb
--symbol_map=ldexpd=ldexp
--symbol_map=lgammad=lgamma
--symbol_map=lgammad_r=lgamma_r
--symbol_map=logd=log
--symbol_map=log2d=log2
--symbol_map=log10d=log10
--symbol_map=log1pd=log1p
--symbol_map=logbd=logb
--symbol_map=madd=mad
--symbol_map=maxmagd=maxmag
--symbol_map=minmagd=minmag
--symbol_map=modfd=modf
--symbol_map=nand=nan
--symbol_map=nextafterd=nextafter
--symbol_map=powd=pow
--symbol_map=pownd=pown
--symbol_map=powrd=powr
--symbol_map=remainderd=remainder
--symbol_map=remquod=remquo
--symbol_map=rintd=rint
--symbol_map=rootnd=rootn
--symbol_map=roundd=round
--symbol_map=rsqrtd=rsqrt
--symbol_map=sind=sin
--symbol_map=sincosd=sincos
--symbol_map=sinhd=sinh
--symbol_map=sinpid=sinpi
--symbol_map=sqrtd=sqrt
--symbol_map=tand=tan
--symbol_map=tanhd=tanh
--symbol_map=tanpid=tanpi
--symbol_map=tgammad=tgamma
--symbol_map=truncd=trunc
--symbol_map=native_cosd=native_cos
--symbol_map=native_divided=native_divide
--symbol_map=native_expd=native_exp
--symbol_map=native_exp2d=native_exp2
--symbol_map=native_exp10d=native_exp10
--symbol_map=native_logd=native_log
--symbol_map=native_log2d=native_log2
--symbol_map=native_log10d=native_log10
--symbol_map=native_powrd=native_powr
--symbol_map=native_recipd=native_recip
--symbol_map=native_rsqrtd=native_rsqrt
--symbol_map=native_sind=native_sin
--symbol_map=native_sqrtd=native_sqrt
--symbol_map=native_tand=native_tan
--symbol_map=isinfd=isinf
--symbol_map=isnand=isnan
--symbol_map=__isfinited=__isfinite
--symbol_map=__isnormald=__isnormal

/*-----------------------------------------------------------------------------
* __ocl_<x> names deprecated, but created here for transition period
*----------------------------------------------------------------------------*/
--symbol_map=__ocl_cache_l1d_off=__cache_l1d_none
--symbol_map=__ocl_cache_l1d_std=__cache_l1d_all
--symbol_map=__ocl_cache_l1d_half=__cache_l1d_16k
--symbol_map=__ocl_cache_l1d_wbinv_all=__cache_l1d_wbinv_all
